/**
 * Convert string into snake case.
 * Join punctuation with underscore.
 * @memberof module:stringcase/lib
 * @function snakecase
 * @param {string} str - String to convert.
 * @returns {string} Snake cased string.
 */

'use strict';

var lowercase = require('./lowercase');
var uppercase = require('./uppercase');

var JOINER = '_';

var replacing = {
  from: /([A-Z])/g,
  to: function to($1) {
    return JOINER + lowercase($1);
  }
};

/** @lends snakecase */
function snakecase(str) {
  if (snakecase.isSnakecase(str)) {
    return str;
  }
  str = String(str).replace(/[\-\.\s]/g, JOINER);
  if (!str) {
    return str;
  }
  if (uppercase.isUppercase(str)) {
    str = lowercase(str);
  }
  return lowercase(str[0]) + str.slice(1).replace(replacing.from, replacing.to).replace(/_+/g, '_');
}

/**
 * Checks whether the string are snakecase.
 * @memberof module:stringcase/lib
 * @function snakecase.isSnakecase
 * @param {string} str - String to check.
 * @returns {boolean} - True if the string are snakecase.
 */
snakecase.isSnakecase = function (str) {
  return str && /^[a-z_]+$/.test(str);
};

module.exports = snakecase;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNuYWtlY2FzZS5qcyJdLCJuYW1lcyI6WyJsb3dlcmNhc2UiLCJyZXF1aXJlIiwidXBwZXJjYXNlIiwiSk9JTkVSIiwicmVwbGFjaW5nIiwiZnJvbSIsInRvIiwiJDEiLCJzbmFrZWNhc2UiLCJzdHIiLCJpc1NuYWtlY2FzZSIsIlN0cmluZyIsInJlcGxhY2UiLCJpc1VwcGVyY2FzZSIsInNsaWNlIiwidGVzdCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7QUFTQTs7QUFFQSxJQUFNQSxZQUFZQyxRQUFRLGFBQVIsQ0FBbEI7QUFDQSxJQUFNQyxZQUFZRCxRQUFRLGFBQVIsQ0FBbEI7O0FBRUEsSUFBTUUsU0FBUyxHQUFmOztBQUVBLElBQU1DLFlBQVk7QUFDaEJDLFFBQU0sVUFEVTtBQUVoQkMsTUFBSSxZQUFVQyxFQUFWLEVBQWM7QUFDaEIsV0FBT0osU0FBU0gsVUFBVU8sRUFBVixDQUFoQjtBQUNEO0FBSmUsQ0FBbEI7O0FBT0E7QUFDQSxTQUFTQyxTQUFULENBQW9CQyxHQUFwQixFQUF5QjtBQUN2QixNQUFJRCxVQUFVRSxXQUFWLENBQXNCRCxHQUF0QixDQUFKLEVBQWdDO0FBQzlCLFdBQU9BLEdBQVA7QUFDRDtBQUNEQSxRQUFNRSxPQUFPRixHQUFQLEVBQVlHLE9BQVosQ0FBb0IsV0FBcEIsRUFBaUNULE1BQWpDLENBQU47QUFDQSxNQUFJLENBQUNNLEdBQUwsRUFBVTtBQUNSLFdBQU9BLEdBQVA7QUFDRDtBQUNELE1BQUlQLFVBQVVXLFdBQVYsQ0FBc0JKLEdBQXRCLENBQUosRUFBZ0M7QUFDOUJBLFVBQU1ULFVBQVVTLEdBQVYsQ0FBTjtBQUNEO0FBQ0QsU0FBT1QsVUFBVVMsSUFBSyxDQUFMLENBQVYsSUFBc0JBLElBQUlLLEtBQUosQ0FBVSxDQUFWLEVBQWFGLE9BQWIsQ0FBcUJSLFVBQVVDLElBQS9CLEVBQXFDRCxVQUFVRSxFQUEvQyxFQUFtRE0sT0FBbkQsQ0FBMkQsS0FBM0QsRUFBa0UsR0FBbEUsQ0FBN0I7QUFDRDs7QUFFRDs7Ozs7OztBQU9BSixVQUFVRSxXQUFWLEdBQXdCLFVBQVVELEdBQVYsRUFBZTtBQUNyQyxTQUFPQSxPQUFPLFlBQVlNLElBQVosQ0FBaUJOLEdBQWpCLENBQWQ7QUFDRCxDQUZEOztBQUlBTyxPQUFPQyxPQUFQLEdBQWlCVCxTQUFqQiIsImZpbGUiOiJzbmFrZWNhc2UuanMiLCJzb3VyY2VSb290IjoibGliIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb252ZXJ0IHN0cmluZyBpbnRvIHNuYWtlIGNhc2UuXG4gKiBKb2luIHB1bmN0dWF0aW9uIHdpdGggdW5kZXJzY29yZS5cbiAqIEBtZW1iZXJvZiBtb2R1bGU6c3RyaW5nY2FzZS9saWJcbiAqIEBmdW5jdGlvbiBzbmFrZWNhc2VcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgLSBTdHJpbmcgdG8gY29udmVydC5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFNuYWtlIGNhc2VkIHN0cmluZy5cbiAqL1xuXG4ndXNlIHN0cmljdCdcblxuY29uc3QgbG93ZXJjYXNlID0gcmVxdWlyZSgnLi9sb3dlcmNhc2UnKVxuY29uc3QgdXBwZXJjYXNlID0gcmVxdWlyZSgnLi91cHBlcmNhc2UnKVxuXG5jb25zdCBKT0lORVIgPSAnXyc7XG5cbmNvbnN0IHJlcGxhY2luZyA9IHtcbiAgZnJvbTogLyhbQS1aXSkvZyxcbiAgdG86IGZ1bmN0aW9uICgkMSkge1xuICAgIHJldHVybiBKT0lORVIgKyBsb3dlcmNhc2UoJDEpXG4gIH1cbn1cblxuLyoqIEBsZW5kcyBzbmFrZWNhc2UgKi9cbmZ1bmN0aW9uIHNuYWtlY2FzZSAoc3RyKSB7XG4gIGlmIChzbmFrZWNhc2UuaXNTbmFrZWNhc2Uoc3RyKSkge1xuICAgIHJldHVybiBzdHJcbiAgfVxuICBzdHIgPSBTdHJpbmcoc3RyKS5yZXBsYWNlKC9bXFwtXFwuXFxzXS9nLCBKT0lORVIpXG4gIGlmICghc3RyKSB7XG4gICAgcmV0dXJuIHN0clxuICB9XG4gIGlmICh1cHBlcmNhc2UuaXNVcHBlcmNhc2Uoc3RyKSkge1xuICAgIHN0ciA9IGxvd2VyY2FzZShzdHIpXG4gIH1cbiAgcmV0dXJuIGxvd2VyY2FzZShzdHJbIDAgXSkgKyBzdHIuc2xpY2UoMSkucmVwbGFjZShyZXBsYWNpbmcuZnJvbSwgcmVwbGFjaW5nLnRvKS5yZXBsYWNlKC9fKy9nLCAnXycpXG59XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIHN0cmluZyBhcmUgc25ha2VjYXNlLlxuICogQG1lbWJlcm9mIG1vZHVsZTpzdHJpbmdjYXNlL2xpYlxuICogQGZ1bmN0aW9uIHNuYWtlY2FzZS5pc1NuYWtlY2FzZVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciAtIFN0cmluZyB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIHN0cmluZyBhcmUgc25ha2VjYXNlLlxuICovXG5zbmFrZWNhc2UuaXNTbmFrZWNhc2UgPSBmdW5jdGlvbiAoc3RyKSB7XG4gIHJldHVybiBzdHIgJiYgL15bYS16X10rJC8udGVzdChzdHIpXG59XG5cbm1vZHVsZS5leHBvcnRzID0gc25ha2VjYXNlO1xuIl19