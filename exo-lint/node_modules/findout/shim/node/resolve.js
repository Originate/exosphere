/**
 * Resolve to findout.
 * @function findout.resolve
 * @param {string} name - Module name.
 * @param {object} [options] - Optional settings.
 * @param {string} [options.cwd=process.cwd()] - Current working directory.
 * @param {boolean} [options.safe=false] - No throw when not found.
 * @returns {*} - Resolved module.
 * @throws - Module not found error.
 */

'use strict';

var path = require('path'),
    _isModule = require('./_is_module');

/** @lends resolve */
function resolve(name) {
  var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

  if (_isModule(name)) {
    return name;
  }
  var cwd = options.cwd || process.cwd();
  var safe = !!options.safe;
  do {
    var fromDir = path.join(cwd, name);
    if (_isModule(fromDir)) {
      return fromDir;
    }
    var fromNodeModulesDir = path.join(cwd, 'node_modules', name);
    if (_isModule(fromNodeModulesDir)) {
      return fromNodeModulesDir;
    }

    var parentBasedir = path.dirname(cwd);
    if (parentBasedir === cwd) {
      break;
    }
    cwd = parentBasedir;
  } while (true);
  if (safe) {
    return null;
  } else {
    throw new Error('Module not found: ' + name);
  }
}

module.exports = resolve;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc29sdmUuanMiXSwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJfaXNNb2R1bGUiLCJyZXNvbHZlIiwibmFtZSIsIm9wdGlvbnMiLCJjd2QiLCJwcm9jZXNzIiwic2FmZSIsImZyb21EaXIiLCJqb2luIiwiZnJvbU5vZGVNb2R1bGVzRGlyIiwicGFyZW50QmFzZWRpciIsImRpcm5hbWUiLCJFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7OztBQVdBOztBQUVBLElBQU1BLE9BQU9DLFFBQVEsTUFBUixDQUFiO0FBQUEsSUFDRUMsWUFBWUQsUUFBUSxjQUFSLENBRGQ7O0FBR0E7QUFDQSxTQUFTRSxPQUFULENBQWtCQyxJQUFsQixFQUFzQztBQUFBLE1BQWRDLE9BQWMseURBQUosRUFBSTs7QUFDcEMsTUFBSUgsVUFBVUUsSUFBVixDQUFKLEVBQXFCO0FBQ25CLFdBQU9BLElBQVA7QUFDRDtBQUNELE1BQUlFLE1BQU1ELFFBQVFDLEdBQVIsSUFBZUMsUUFBUUQsR0FBUixFQUF6QjtBQUNBLE1BQUlFLE9BQU8sQ0FBQyxDQUFDSCxRQUFRRyxJQUFyQjtBQUNBLEtBQUc7QUFDRCxRQUFJQyxVQUFVVCxLQUFLVSxJQUFMLENBQVVKLEdBQVYsRUFBZUYsSUFBZixDQUFkO0FBQ0EsUUFBSUYsVUFBVU8sT0FBVixDQUFKLEVBQXdCO0FBQ3RCLGFBQU9BLE9BQVA7QUFDRDtBQUNELFFBQUlFLHFCQUFxQlgsS0FBS1UsSUFBTCxDQUFVSixHQUFWLEVBQWUsY0FBZixFQUErQkYsSUFBL0IsQ0FBekI7QUFDQSxRQUFJRixVQUFVUyxrQkFBVixDQUFKLEVBQW1DO0FBQ2pDLGFBQU9BLGtCQUFQO0FBQ0Q7O0FBRUQsUUFBSUMsZ0JBQWdCWixLQUFLYSxPQUFMLENBQWFQLEdBQWIsQ0FBcEI7QUFDQSxRQUFJTSxrQkFBa0JOLEdBQXRCLEVBQTJCO0FBQ3pCO0FBQ0Q7QUFDREEsVUFBTU0sYUFBTjtBQUNELEdBZkQsUUFlUyxJQWZUO0FBZ0JBLE1BQUlKLElBQUosRUFBVTtBQUNSLFdBQU8sSUFBUDtBQUNELEdBRkQsTUFFTztBQUNMLFVBQU0sSUFBSU0sS0FBSix3QkFBK0JWLElBQS9CLENBQU47QUFDRDtBQUNGOztBQUVEVyxPQUFPQyxPQUFQLEdBQWlCYixPQUFqQiIsImZpbGUiOiJyZXNvbHZlLmpzIiwic291cmNlUm9vdCI6ImxpYiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVzb2x2ZSB0byBmaW5kb3V0LlxuICogQGZ1bmN0aW9uIGZpbmRvdXQucmVzb2x2ZVxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBNb2R1bGUgbmFtZS5cbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBPcHRpb25hbCBzZXR0aW5ncy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5jd2Q9cHJvY2Vzcy5jd2QoKV0gLSBDdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5LlxuICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5zYWZlPWZhbHNlXSAtIE5vIHRocm93IHdoZW4gbm90IGZvdW5kLlxuICogQHJldHVybnMgeyp9IC0gUmVzb2x2ZWQgbW9kdWxlLlxuICogQHRocm93cyAtIE1vZHVsZSBub3QgZm91bmQgZXJyb3IuXG4gKi9cblxuJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyksXG4gIF9pc01vZHVsZSA9IHJlcXVpcmUoJy4vX2lzX21vZHVsZScpO1xuXG4vKiogQGxlbmRzIHJlc29sdmUgKi9cbmZ1bmN0aW9uIHJlc29sdmUgKG5hbWUsIG9wdGlvbnMgPSB7fSkge1xuICBpZiAoX2lzTW9kdWxlKG5hbWUpKSB7XG4gICAgcmV0dXJuIG5hbWVcbiAgfVxuICBsZXQgY3dkID0gb3B0aW9ucy5jd2QgfHwgcHJvY2Vzcy5jd2QoKVxuICBsZXQgc2FmZSA9ICEhb3B0aW9ucy5zYWZlXG4gIGRvIHtcbiAgICBsZXQgZnJvbURpciA9IHBhdGguam9pbihjd2QsIG5hbWUpXG4gICAgaWYgKF9pc01vZHVsZShmcm9tRGlyKSkge1xuICAgICAgcmV0dXJuIGZyb21EaXJcbiAgICB9XG4gICAgdmFyIGZyb21Ob2RlTW9kdWxlc0RpciA9IHBhdGguam9pbihjd2QsICdub2RlX21vZHVsZXMnLCBuYW1lKVxuICAgIGlmIChfaXNNb2R1bGUoZnJvbU5vZGVNb2R1bGVzRGlyKSkge1xuICAgICAgcmV0dXJuIGZyb21Ob2RlTW9kdWxlc0RpclxuICAgIH1cblxuICAgIHZhciBwYXJlbnRCYXNlZGlyID0gcGF0aC5kaXJuYW1lKGN3ZClcbiAgICBpZiAocGFyZW50QmFzZWRpciA9PT0gY3dkKSB7XG4gICAgICBicmVha1xuICAgIH1cbiAgICBjd2QgPSBwYXJlbnRCYXNlZGlyXG4gIH0gd2hpbGUgKHRydWUpXG4gIGlmIChzYWZlKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1vZHVsZSBub3QgZm91bmQ6ICR7bmFtZX1gKVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmVzb2x2ZVxuIl19