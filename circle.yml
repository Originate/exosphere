machine:

  node:
    version: 6.1.0

  services:
    - docker


dependencies:

  pre:
    - mkdir -p $CIRCLE_TEST_REPORTS/cucumber
    - curl --output morula --location --fail https://github.com/Originate/morula/releases/download/0.0.4/morula-linux-amd64 && chmod +x morula
    # - git config --global user.email "circle@email.com"
    # - git config --global user.name "circleci"


  override:
    - 'if [ "$CIRCLE_BRANCH" == "master" ]; then ./morula all bin/setup; else echo skipping; fi'
    - 'if [ "$CIRCLE_BRANCH" != "master" ]; then ./morula changed bin/setup; else echo skipping; fi'


test:

  override:
    - 'if [ "${CIRCLE_BRANCH}" == "master" ]; then ./morula all bin/spec_circle; else echo skipping; fi'
    - 'if [ "${CIRCLE_BRANCH}" != "master" ]; then ./morula changed bin/spec_circle; else echo skipping; fi'
