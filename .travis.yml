language: node_js

sudo: required
dist: trusty

services:
  - docker

node_js:
  - "6"
  - "7"


before_install:
  # clone a real copy of the repo because Travis only clones one branch
  - git clone --depth 10 --no-single-branch https://github.com/$TRAVIS_REPO_SLUG.git $TRAVIS_REPO_SLUG
  - cd $TRAVIS_REPO_SLUG
  - git checkout $TRAVIS_BRANCH
  - curl --output morula --location --fail https://github.com/Originate/morula/releases/download/0.0.5/morula-linux-amd64 && chmod +x morula


install:
  - ./morula changed bin/setup
  - 'if [ "$TRAVIS_BRANCH" == "master" ]; then ./morula all bin/setup; else echo skipping; fi'
  - 'if [ "$TRAVIS_BRANCH" != "master" ]; then ./morula changed bin/setup; else echo skipping; fi'


before_script:
  # - git config --global user.email "circle@email.com"
  # - git config --global user.name "circleci"

script:
  - 'if [ "${TRAVIS_BRANCH}" == "master" ]; then ./morula all bin/spec_ci; else echo skipping; fi'
  - 'if [ "${TRAVIS_BRANCH}" != "master" ]; then ./morula changed bin/spec_ci; else echo skipping; fi'


notifications:
  email: false
